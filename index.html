<!DOCTYPE html>
<html>
  <body> 
        <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
     <meta charset="UTF-8">
     <link rel="stylesheet" src="style.css">
     <script src="jquery.min.js"></script>
	<script>
              function click() {
                  alert("Thanks!")
               }
		$(document).ready(function() {
   $('h1').html("<em>Hello, World</em>").fadeOut(500)
   $('h1').html("<em>Hello, World</em>").fadeIn(500)
    $('h1').html("<em>Hello, World</em>").slideUp(500)
     $('h1').html("<em>Hello, World</em>").slideDown(500);
    $('h3').html("user is user and password is password");
     $('button').css("background-color", "teal");
})
	</script>
         <script>
  window.va = window.va || function () { (window.vaq = window.vaq || []).push(arguments); };
</script>
<h3 class="text-3xl font-bold flex underline"></h3>
<script defer src="/_vercel/insights/script.js"></script>
          <button><h1></h1></button>
          <button onclick="click()">Click here!</button>
	<div id="login-form">
       <style type="text/tailwindcss">
   @theme {
       --color-clifford: grey;
   }
	</style>
        <h2>Login</h2>
        <div id="login-message" class="message"></div>
        <form id="auth-form">
            <label for="username"><b>Username</b></label>
            <input type="text" placeholder="Enter Username" name="username" id="username" required>

            <label for="password"><b>Password</b></label>
            <input type="password" placeholder="Enter Password" name="password" id="password" required>
            
            <button type="submit" id="login-button">Login</button>
        </form>
    </div>
    <script>
    let isAuthenticated = false;
let userToken = null; // Simulated token storage

// --- UI Management ---

function showProtectedContent(username) {
    $('#login-form').hide();
    $('#user-display').text(username);
    $('#protected-content').show();
}
function showLoginForm() {
    $('#protected-content').hide();
    $('#login-form').show();
    $('#login-message').text('');
    $('#auth-form')[0].reset(); // Clear form fields
}

// --- API Simulation ---

// Conceptual backend endpoint for login
function apiLogin(username, password) {
    return new Promise((resolve, reject) => {
        // Simulate API delay
        setTimeout(() => {
            if (username === 'user' && password === 'password') {
                // In a real app, the backend would set HTTP-only cookies here.
                // We simulate a successful login by setting a token.
                userToken = 'T!#11@#4@!!@';
                isAuthenticated = true;
                resolve({ success: true, message: 'Login successful', user: username });
            } else {
                reject({ status: 401, message: 'Invalid credentials' });
            }
        }, 500);
    });
}

// Conceptual backend endpoint for protected data
function apiFetchProtectedData() {
    return new Promise((resolve, reject) => {
        // Simulate API delay
        setTimeout(() => {
            if (isAuthenticated && userToken) {
                // In a real app, the browser automatically sends the HTTP-only cookie.
                // The backend validates the token from the cookie.
                resolve({ success: true, data: 'Secret data from the server!', user: $('#user-display').text() });
            } else {
                // Simulate 401 Unauthorized response
                reject({ status: 401, message: 'Unauthorized. Token expired or missing.' });
            }
        }, 500);
    });
}

// Conceptual backend endpoint for logout
function apiLogout() {
    return new Promise((resolve) => {
        // In a real app, the backend would clear the HTTP-only cookies.
        userToken = null;
        isAuthenticated = false;
        resolve({ success: true, message: 'Logout successful' });
    });
}

// --- Event Handlers ---

// Login Handler
$('#login-form').on('submit', function(e) {
    e.preventDefault();
    
    // 1. Collect the data from the form inputs
    const username = $('#username').val();
    const password = $('#password').val();

    $.ajax({
        // 2. Specify the URL of the backend endpoint
        url: 'http://httpbin.org/post', 
        
        // 3. Specify the HTTP method (POST for sending data)
        method: 'POST', 
        
        // 4. Tell the server what format the data is in (JSON is standard for APIs)
        contentType: 'application/json', 
        
        // 5. The data to be sent, converted into a JSON string
        data: JSON.stringify({ username, password }), 
        
        // 6. Handle a successful response (HTTP status 200-299)
        success: function(response) {
            // Backend successfully validated credentials and set cookies.
            // Redirect the user or update the UI.
            window.location.href = '/';
        },
        
        // 7. Handle an error response (HTTP status 400+)
        error: function(xhr, status, error) {
            // xhr.responseJSON contains the error details from the server.
            const errorMessage = xhr.responseJSON ? xhr.responseJSON.message : 'An unknown error occurred.';
            $('#login-message').text('Login failed: ' + errorMessage);
        }
    });

// Fetch Protected Data Handler
$('#fetch-data-button').on('click', function() {
    $('#data-output').text('Fetching data...');
    apiFetchProtectedData()
        .then(response => {
            $('#data-output').html('<strong>Data Received:</strong> ' + response.data);
        })
        .catch(error => {
            if (error.status === 401) {
                // In a real app, this is where you would attempt a token refresh.
                // If refresh fails, redirect to login.
                $('#data-output').html('<strong>Error 401:</strong> ' + error.message + ' Redirecting to login...');
                setTimeout(showLoginForm, 2000);
            } else {
                $('#data-output').html('<strong>Error:</strong> ' + error.message);
            }
        });
});

// Logout Handler
$('#logout-button').on('click', function() {
    apiLogout().then(() => {
        showLoginForm();
    });
});

// Initial state check
$(document).ready(function() {
    // In a real app, you would check for the presence of the auth cookie here.
    if (isAuthenticated) {
        showProtectedContent('user'); // Assuming 'user' is known or retrieved
    } else {
        showLoginForm();
    }
});
</script>
    <div id="protected-content">
        <h2>Welcome, <span id="user-display">User</span>!</h2>
        <p>This is protected content, only visible after successful authentication.</p>
        <button id="fetch-data-button">Fetch Protected Data</button>
        <div id="data-output" style="margin-top: 15px; padding: 10px; border: 1px dashed #aaa;">Click 'Fetch Protected Data'</div>
        <button id="logout-button" style="background-color: #f44336;">Logout</button>
    </div>
        </body>
</html>

