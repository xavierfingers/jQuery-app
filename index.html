<!DOCTYPE html>
<html>
  <body> 
     <meta charset="UTF-8">
     <link rel="stylesheet" src="style.css">
     <script src="jquery.min.js"></script>
	<script>
              function click() {
                  alert("Thanks!")
               }
		$(document).ready(function() {
   $('h1').html("<em>Hello, World</em>").fadeOut(500)
   $('h1').html("<em>Hello, World</em>").fadeIn(500)
    $('h1').html("<em>Hello, World</em>").slideUp(500)
     $('h1').html("<em>Hello, World</em>").slideDown(500);
     $('button').css("background-color", "teal");
})
	</script>
         <script>
  window.va = window.va || function () { (window.vaq = window.vaq || []).push(arguments); };
</script>
<script defer src="/_vercel/insights/script.js"></script>
          <button><h1></h1></button>
          <button onclick="click()">Click here!</button>
	<div id="login-form">
        <h2>Login</h2>
        <div id="login-message" class="message"></div>
        <form id="auth-form">
            <label for="username"><b>Username</b></label>
            <input type="text" placeholder="Enter Username" name="username" id="username" required>

            <label for="password"><b>Password</b></label>
            <input type="password" placeholder="Enter Password" name="password" id="password" required>
            
            <button type="submit" id="login-button">Login</button>
        </form>
    </div>
    <script>
    let isAuthenticated = false;
let userToken = null; // Simulated token storage

// --- UI Management ---

function showProtectedContent(username) {
    $('#login-form').hide();
    $('#user-display').text(username);
    $('#protected-content').show();
}

function showLoginForm() {
    $('#protected-content').hide();
    $('#login-form').show();
    $('#login-message').text('');
    $('#auth-form')[0].reset(); // Clear form fields
}

// --- API Simulation ---

// Conceptual backend endpoint for login
function apiLogin(username, password) {
    return new Promise((resolve, reject) => {
        // Simulate API delay
        setTimeout(() => {
            if (username === 'user' && password === 'password') {
                // In a real app, the backend would set HTTP-only cookies here.
                // We simulate a successful login by setting a token.
                userToken = 'simulated_jwt_token_12345';
                isAuthenticated = true;
                resolve({ success: true, message: 'Login successful', user: username });
            } else {
                reject({ status: 401, message: 'Invalid credentials' });
            }
        }, 500);
    });
}

// Conceptual backend endpoint for protected data
function apiFetchProtectedData() {
    return new Promise((resolve, reject) => {
        // Simulate API delay
        setTimeout(() => {
            if (isAuthenticated && userToken) {
                // In a real app, the browser automatically sends the HTTP-only cookie.
                // The backend validates the token from the cookie.
                resolve({ success: true, data: 'Secret data from the server!', user: $('#user-display').text() });
            } else {
                // Simulate 401 Unauthorized response
                reject({ status: 401, message: 'Unauthorized. Token expired or missing.' });
            }
        }, 500);
    });
}

// Conceptual backend endpoint for logout
function apiLogout() {
    return new Promise((resolve) => {
        // In a real app, the backend would clear the HTTP-only cookies.
        userToken = null;
        isAuthenticated = false;
        resolve({ success: true, message: 'Logout successful' });
    });
}

// --- Event Handlers ---

// Login Handler
$('#auth-form').on('submit', function(e) {
    e.preventDefault();
    const username = $('#username').val();
    const password = $('#password').val();
    const $loginButton = $('#login-button');

    $loginButton.prop('disabled', true).text('Logging in...');
    $('#login-message').text('');

    apiLogin(username, password)
        .then(response => {
            showProtectedContent(response.user);
        })
        .catch(error => {
            $('#login-message').text('Error: ' + error.message);
        })
        .finally(() => {
            $loginButton.prop('disabled', false).text('Login');
        });
});

// Fetch Protected Data Handler
$('#fetch-data-button').on('click', function() {
    $('#data-output').text('Fetching data...');
    apiFetchProtectedData()
        .then(response => {
            $('#data-output').html('<strong>Data Received:</strong> ' + response.data);
        })
        .catch(error => {
            if (error.status === 401) {
                // In a real app, this is where you would attempt a token refresh.
                // If refresh fails, redirect to login.
                $('#data-output').html('<strong>Error 401:</strong> ' + error.message + ' Redirecting to login...');
                setTimeout(showLoginForm, 2000);
            } else {
                $('#data-output').html('<strong>Error:</strong> ' + error.message);
            }
        });
});

// Logout Handler
$('#logout-button').on('click', function() {
    apiLogout().then(() => {
        showLoginForm();
    });
});

// Initial state check
$(document).ready(function() {
    // In a real app, you would check for the presence of the auth cookie here.
    if (isAuthenticated) {
        showProtectedContent('user'); // Assuming 'user' is known or retrieved
    } else {
        showLoginForm();
    }
});
</script>
    <div id="protected-content">
        <h2>Welcome, <span id="user-display">User</span>!</h2>
        <p>This is protected content, only visible after successful authentication.</p>
        <button id="fetch-data-button">Fetch Protected Data</button>
        <div id="data-output" style="margin-top: 15px; padding: 10px; border: 1px dashed #aaa;">Click 'Fetch Protected Data'</div>
        <button id="logout-button" style="background-color: #f44336;">Logout</button>
    </div>
        </body>
</html>

